

-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
--- JOIN FEATURES INTO FINAL DATASETS
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
drop table if exists welds_25_datasets_features;
create table welds_25_datasets_features as
select 
         a."CarbodyID",
         a.weld_timestamp,
         a.extensionID,
         a."StudID",
         a."uniqueID",
         a."WeldTimeActual",
         a."WeldVoltageActual",
         a."WeldEnergyActual",
         a."PilotVoltageActual",
         a."LMLiftHeightActual",
         a."LMPenetrationActual",
         a."DropTimeActual",
         a."fingerprint",
         a."MMP.SystemTotalWelds",
         a."MMP.OutletTotalWelds",
         a."MMP.OutletTotalWOPs",
         a."MMP.WeldToolTotalWelds",
         a."MMP.ProgTotalWelds",
         a."MMP.WeldProcess",
         a."MMP.PilotCurrentActual",
         a."MMP.PilotTimeActual",
         a."MMP.WeldCurrentActualNegative",
         a."MMP.LMPositionActual",
         a."MMP.LiftFinishedMode",
         a."MMP.ProtectiveGasPreFlowActive",
         a."MMP.ProtectiveGasFlowDuringWeldprocessActive",
         a."MMP.ProtectiveGasPostFlowActive",
         a."MMP.CleanCurrentActual",
         a."MMP.CleanVoltageActual", 
         a."MMP.WeldToolSlideForwardMoveTime",
         a."MMP.WeldToolSlideForwardResponseTimeActualLeaveBackPosition",
         a."MMP.WeldToolSlideBackwardMoveTime",
         a."MMP.FeedingTimeActual",
         a."MMP.FeedingTimeStudInTube",
         a."MMP.WeldToolMoveTimeLoadingPinBackward",
         a."MMP.WeldToolMoveTimeLoadingPinForward",
         a."Voltage.FFT_1_LOC",
         a."Voltage.FFT_1_VALUE",
         a."Voltage.FFT_2_LOC",
         a."Voltage.FFT_2_VALUE",
         a."Voltage.FFT_3_LOC",
         a."Voltage.FFT_3_VALUE",
         a."Voltage.PSD_1_LOC",
         a."Voltage.PSD_1_VALUE",
         a."Voltage.PSD_2_LOC",
         a."Voltage.PSD_2_VALUE",
         a."Voltage.PSD_3_LOC",
         a."Voltage.PSD_3_VALUE",
         a."Voltage.ACF_Entropy",
         a."Voltage.ACF_ZeroCrossings",
         a."Voltage.ACF_MeanCrossings",
         a."Voltage.ACF_Quantile5",
         a."Voltage.ACF_Quantile25",
         a."Voltage.ACF_Quantile75",
         a."Voltage.ACF_Quantile95",
         a."Voltage.ACF_Median",
         a."Voltage.ACF_Mean",
         a."Voltage.ACF_StdDeviation",
         a."Voltage.ACF_Variance",
         a."Voltage.ACF_RMS",
         a."Voltage.PACF_Entropy",
         a."Voltage.PACF_ZeroCrossings",
         a."Voltage.PACF_MeanCrossings",
         a."Voltage.PACF_Quantile5",
         a."Voltage.PACF_Quantile25",
         a."Voltage.PACF_Quantile75",
         a."Voltage.PACF_Quantile95",
         a."Voltage.PACF_Median",
         a."Voltage.PACF_Mean",
         a."Voltage.PACF_StdDeviation",
         a."Voltage.PACF_Variance",
         a."Voltage.PACF_RMS",
         a."Voltage.CWT_1_TIME",
         a."Voltage.CWT_1_FREQ",
         a."Voltage.CWT_1_VALUE",
         a."Voltage.CWT_2_TIME",
         a."Voltage.CWT_2_FREQ",
         a."Voltage.CWT_2_VALUE",
         a."Voltage.CWT_3_TIME",
         a."Voltage.CWT_3_FREQ",
         a."Voltage.CWT_3_VALUE",
         a."Voltage.DTW_Distance",
         a."Current.FFT_1_LOC",
         a."Current.FFT_1_VALUE",
         a."Current.FFT_2_LOC",
         a."Current.FFT_2_VALUE",
         a."Current.FFT_3_LOC",
         a."Current.FFT_3_VALUE",
         a."Current.PSD_1_LOC",
         a."Current.PSD_1_VALUE",
         a."Current.PSD_2_LOC",
         a."Current.PSD_2_VALUE",
         a."Current.PSD_3_LOC",
         a."Current.PSD_3_VALUE",
         a."Current.ACF_Entropy",
         a."Current.ACF_ZeroCrossings",
         a."Current.ACF_MeanCrossings",
         a."Current.ACF_Quantile5",
         a."Current.ACF_Quantile25",
         a."Current.ACF_Quantile75",
         a."Current.ACF_Quantile95",
         a."Current.ACF_Median",
         a."Current.ACF_Mean",
         a."Current.ACF_StdDeviation",
         a."Current.ACF_Variance",
         a."Current.ACF_RMS",
         a."Current.PACF_Entropy",
         a."Current.PACF_ZeroCrossings",
         a."Current.PACF_MeanCrossings",
         a."Current.PACF_Quantile5",
         a."Current.PACF_Quantile25",
         a."Current.PACF_Quantile75",
         a."Current.PACF_Quantile95",
         a."Current.PACF_Median",
         a."Current.PACF_Mean",
         a."Current.PACF_StdDeviation",
         a."Current.PACF_Variance",
         a."Current.PACF_RMS",
         a."Current.CWT_1_TIME",
         a."Current.CWT_1_FREQ",
         a."Current.CWT_1_VALUE",
         a."Current.CWT_2_TIME",
         a."Current.CWT_2_FREQ",
         a."Current.CWT_2_VALUE",
         a."Current.CWT_3_TIME",
         a."Current.CWT_3_FREQ",
         a."Current.CWT_3_VALUE",
         a."Current.DTW_Distance",
         a."LiftPosition.FFT_1_LOC",
         a."LiftPosition.FFT_1_VALUE",
         a."LiftPosition.FFT_2_LOC",
         a."LiftPosition.FFT_2_VALUE",
         a."LiftPosition.FFT_3_LOC",
         a."LiftPosition.FFT_3_VALUE",
         a."LiftPosition.PSD_1_LOC",
         a."LiftPosition.PSD_1_VALUE",
         a."LiftPosition.PSD_2_LOC",
         a."LiftPosition.PSD_2_VALUE",
         a."LiftPosition.PSD_3_LOC",
         a."LiftPosition.PSD_3_VALUE",
         a."LiftPosition.ACF_Entropy",
         a."LiftPosition.ACF_ZeroCrossings",
         a."LiftPosition.ACF_MeanCrossings",
         a."LiftPosition.ACF_Quantile5",
         a."LiftPosition.ACF_Quantile25",
         a."LiftPosition.ACF_Quantile75",
         a."LiftPosition.ACF_Quantile95",
         a."LiftPosition.ACF_Median",
         a."LiftPosition.ACF_Mean",
         a."LiftPosition.ACF_StdDeviation",
         a."LiftPosition.ACF_Variance",
         a."LiftPosition.ACF_RMS",
         a."LiftPosition.PACF_Entropy",
         a."LiftPosition.PACF_ZeroCrossings",
         a."LiftPosition.PACF_MeanCrossings",
         a."LiftPosition.PACF_Quantile5",
         a."LiftPosition.PACF_Quantile25",
         a."LiftPosition.PACF_Quantile75",
         a."LiftPosition.PACF_Quantile95",
         a."LiftPosition.PACF_Median",
         a."LiftPosition.PACF_Mean",
         a."LiftPosition.PACF_StdDeviation",
         a."LiftPosition.PACF_Variance",
         a."LiftPosition.PACF_RMS",
         a."LiftPosition.CWT_1_TIME",
         a."LiftPosition.CWT_1_FREQ",
         a."LiftPosition.CWT_1_VALUE",
         a."LiftPosition.CWT_2_TIME",
         a."LiftPosition.CWT_2_FREQ",
         a."LiftPosition.CWT_2_VALUE",
         a."LiftPosition.CWT_3_TIME",
         a."LiftPosition.CWT_3_FREQ",
         a."LiftPosition.CWT_3_VALUE",
         a."LiftPosition.DTW_Distance",
         a."LMCurrent.DTW_Distance",
         a."has_missing_values",
         a."missing_fields",
         b.penetration_avg_diff_1m,
         b.energy_avg_diff_1m,
         b.droptime_avg_diff_1m,
         b.stickout_avg_diff_1m,
         b.lift_avg_diff_1m,
         b.time_avg_diff_1m,
         b.current_avg_diff_1m,
         b.voltage_avg_diff_1m,
         c.penetration_avg_diff_5m,
         c.energy_avg_diff_5m,
         c.droptime_avg_diff_5m,
         c.stickout_avg_diff_5m,
         c.lift_avg_diff_5m,
         c.time_avg_diff_5m,
         c.current_avg_diff_5m,
         c.voltage_avg_diff_5m,
         d.penetration_avg_diff_15m,
         d.energy_avg_diff_15m,
         d.droptime_avg_diff_15m,
         d.stickout_avg_diff_15m,
         d.lift_avg_diff_15m,
         d.time_avg_diff_15m,
         d.current_avg_diff_15m,
         d.voltage_avg_diff_15m,
         e.penetration_avg_diff_60m,
         e.energy_avg_diff_60m,
         e.droptime_avg_diff_60m,
         e.stickout_avg_diff_60m,
         e.lift_avg_diff_60m,
         e.time_avg_diff_60m,
         e.current_avg_diff_60m,
         e.voltage_avg_diff_60m,
         a."score",
         a."BodyShopRepair",
         a."AssemblyShopRepair",
         a."Error"
from welds_25_datasets a, 
     welds_25_datasets_avg_features_1m b,
     welds_25_datasets_avg_features_5m c,
     welds_25_datasets_avg_features_15m d,
     welds_25_datasets_avg_features_60m e
where a.fingerprint = b.fingerprint and
      a.fingerprint = c.fingerprint and
      a.fingerprint = d.fingerprint and
      a.fingerprint = e.fingerprint;



