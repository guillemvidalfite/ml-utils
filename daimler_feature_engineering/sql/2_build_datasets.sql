

-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
--- JOIN FEATURES INTO FINAL DATASETS
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
drop table if exists welds_25_datasets_features;
create table welds_25_datasets_features as
select 
         a."CarbodyID",
         a.weld_timestamp,
         a.extensionID,
         a."StudID",
         a."uniqueID",
         a."WeldTimeActual",
         a."WeldVoltageActual",
         a."WeldEnergyActual",
         a."PilotVoltageActual",
         a."LMLiftHeightActual",
         a."LMPenetrationActual",
         a."DropTimeActual",
         a."fingerprint",
         a."MMP.SystemTotalWelds",
         a."MMP.OutletTotalWelds",
         a."MMP.OutletTotalWOPs",
         a."MMP.WeldToolTotalWelds",
         a."MMP.ProgTotalWelds",
         a."MMP.WeldProcess",
         a."MMP.PilotCurrentActual",
         a."MMP.PilotTimeActual",
         a."MMP.WeldCurrentActualNegative",
         a."MMP.LMPositionActual",
         a."MMP.LiftFinishedMode",
         a."MMP.ProtectiveGasPreFlowActive",
         a."MMP.ProtectiveGasFlowDuringWeldprocessActive",
         a."MMP.ProtectiveGasPostFlowActive",
         a."MMP.CleanCurrentActual",
         a."MMP.CleanVoltageActual", 
         a."MMP.WeldToolSlideForwardMoveTime",
         a."MMP.WeldToolSlideForwardResponseTimeActualLeaveBackPosition",
         a."MMP.WeldToolSlideBackwardMoveTime",
         a."MMP.FeedingTimeActual",
         a."MMP.FeedingTimeStudInTube",
         a."MMP.WeldToolMoveTimeLoadingPinBackward",
         a."MMP.WeldToolMoveTimeLoadingPinForward",
         a."Voltage.FFT_1_LOC",
         a."Voltage.FFT_1_VALUE",
         a."Voltage.FFT_2_LOC",
         a."Voltage.FFT_2_VALUE",
         a."Voltage.FFT_3_LOC",
         a."Voltage.FFT_3_VALUE",
         a."Voltage.PSD_1_LOC",
         a."Voltage.PSD_1_VALUE",
         a."Voltage.PSD_2_LOC",
         a."Voltage.PSD_2_VALUE",
         a."Voltage.PSD_3_LOC",
         a."Voltage.PSD_3_VALUE",
         a."Voltage.ACF_Entropy",
         a."Voltage.ACF_ZeroCrossings",
         a."Voltage.ACF_MeanCrossings",
         a."Voltage.ACF_Quantile5",
         a."Voltage.ACF_Quantile25",
         a."Voltage.ACF_Quantile75",
         a."Voltage.ACF_Quantile95",
         a."Voltage.ACF_Median",
         a."Voltage.ACF_Mean",
         a."Voltage.ACF_StdDeviation",
         a."Voltage.ACF_Variance",
         a."Voltage.ACF_RMS",
         a."Voltage.PACF_Entropy",
         a."Voltage.PACF_ZeroCrossings",
         a."Voltage.PACF_MeanCrossings",
         a."Voltage.PACF_Quantile5",
         a."Voltage.PACF_Quantile25",
         a."Voltage.PACF_Quantile75",
         a."Voltage.PACF_Quantile95",
         a."Voltage.PACF_Median",
         a."Voltage.PACF_Mean",
         a."Voltage.PACF_StdDeviation",
         a."Voltage.PACF_Variance",
         a."Voltage.PACF_RMS",
         a."Voltage.CWT_1_TIME",
         a."Voltage.CWT_1_FREQ",
         a."Voltage.CWT_1_VALUE",
         a."Voltage.CWT_2_TIME",
         a."Voltage.CWT_2_FREQ",
         a."Voltage.CWT_2_VALUE",
         a."Voltage.CWT_3_TIME",
         a."Voltage.CWT_3_FREQ",
         a."Voltage.CWT_3_VALUE",
         a."Voltage.DTW_Distance",
         a."Current.FFT_1_LOC",
         a."Current.FFT_1_VALUE",
         a."Current.FFT_2_LOC",
         a."Current.FFT_2_VALUE",
         a."Current.FFT_3_LOC",
         a."Current.FFT_3_VALUE",
         a."Current.PSD_1_LOC",
         a."Current.PSD_1_VALUE",
         a."Current.PSD_2_LOC",
         a."Current.PSD_2_VALUE",
         a."Current.PSD_3_LOC",
         a."Current.PSD_3_VALUE",
         a."Current.ACF_Entropy",
         a."Current.ACF_ZeroCrossings",
         a."Current.ACF_MeanCrossings",
         a."Current.ACF_Quantile5",
         a."Current.ACF_Quantile25",
         a."Current.ACF_Quantile75",
         a."Current.ACF_Quantile95",
         a."Current.ACF_Median",
         a."Current.ACF_Mean",
         a."Current.ACF_StdDeviation",
         a."Current.ACF_Variance",
         a."Current.ACF_RMS",
         a."Current.PACF_Entropy",
         a."Current.PACF_ZeroCrossings",
         a."Current.PACF_MeanCrossings",
         a."Current.PACF_Quantile5",
         a."Current.PACF_Quantile25",
         a."Current.PACF_Quantile75",
         a."Current.PACF_Quantile95",
         a."Current.PACF_Median",
         a."Current.PACF_Mean",
         a."Current.PACF_StdDeviation",
         a."Current.PACF_Variance",
         a."Current.PACF_RMS",
         a."Current.CWT_1_TIME",
         a."Current.CWT_1_FREQ",
         a."Current.CWT_1_VALUE",
         a."Current.CWT_2_TIME",
         a."Current.CWT_2_FREQ",
         a."Current.CWT_2_VALUE",
         a."Current.CWT_3_TIME",
         a."Current.CWT_3_FREQ",
         a."Current.CWT_3_VALUE",
         a."Current.DTW_Distance",
         a."LiftPosition.FFT_1_LOC",
         a."LiftPosition.FFT_1_VALUE",
         a."LiftPosition.FFT_2_LOC",
         a."LiftPosition.FFT_2_VALUE",
         a."LiftPosition.FFT_3_LOC",
         a."LiftPosition.FFT_3_VALUE",
         a."LiftPosition.PSD_1_LOC",
         a."LiftPosition.PSD_1_VALUE",
         a."LiftPosition.PSD_2_LOC",
         a."LiftPosition.PSD_2_VALUE",
         a."LiftPosition.PSD_3_LOC",
         a."LiftPosition.PSD_3_VALUE",
         a."LiftPosition.ACF_Entropy",
         a."LiftPosition.ACF_ZeroCrossings",
         a."LiftPosition.ACF_MeanCrossings",
         a."LiftPosition.ACF_Quantile5",
         a."LiftPosition.ACF_Quantile25",
         a."LiftPosition.ACF_Quantile75",
         a."LiftPosition.ACF_Quantile95",
         a."LiftPosition.ACF_Median",
         a."LiftPosition.ACF_Mean",
         a."LiftPosition.ACF_StdDeviation",
         a."LiftPosition.ACF_Variance",
         a."LiftPosition.ACF_RMS",
         a."LiftPosition.PACF_Entropy",
         a."LiftPosition.PACF_ZeroCrossings",
         a."LiftPosition.PACF_MeanCrossings",
         a."LiftPosition.PACF_Quantile5",
         a."LiftPosition.PACF_Quantile25",
         a."LiftPosition.PACF_Quantile75",
         a."LiftPosition.PACF_Quantile95",
         a."LiftPosition.PACF_Median",
         a."LiftPosition.PACF_Mean",
         a."LiftPosition.PACF_StdDeviation",
         a."LiftPosition.PACF_Variance",
         a."LiftPosition.PACF_RMS",
         a."LiftPosition.CWT_1_TIME",
         a."LiftPosition.CWT_1_FREQ",
         a."LiftPosition.CWT_1_VALUE",
         a."LiftPosition.CWT_2_TIME",
         a."LiftPosition.CWT_2_FREQ",
         a."LiftPosition.CWT_2_VALUE",
         a."LiftPosition.CWT_3_TIME",
         a."LiftPosition.CWT_3_FREQ",
         a."LiftPosition.CWT_3_VALUE",
         a."LiftPosition.DTW_Distance",
         a."LMCurrent.DTW_Distance",
         a."has_missing_values",
         a."missing_fields",
         b.penetration_avg_diff_1m,
         b.energy_avg_diff_1m,
         b.droptime_avg_diff_1m,
         b.stickout_avg_diff_1m,
         b.lift_avg_diff_1m,
         b.time_avg_diff_1m,
         b.current_avg_diff_1m,
         b.voltage_avg_diff_1m,
         c.penetration_avg_diff_5m,
         c.energy_avg_diff_5m,
         c.droptime_avg_diff_5m,
         c.stickout_avg_diff_5m,
         c.lift_avg_diff_5m,
         c.time_avg_diff_5m,
         c.current_avg_diff_5m,
         c.voltage_avg_diff_5m,
         d.penetration_avg_diff_15m,
         d.energy_avg_diff_15m,
         d.droptime_avg_diff_15m,
         d.stickout_avg_diff_15m,
         d.lift_avg_diff_15m,
         d.time_avg_diff_15m,
         d.current_avg_diff_15m,
         d.voltage_avg_diff_15m,
         e.penetration_avg_diff_60m,
         e.energy_avg_diff_60m,
         e.droptime_avg_diff_60m,
         e.stickout_avg_diff_60m,
         e.lift_avg_diff_60m,
         e.time_avg_diff_60m,
         e.current_avg_diff_60m,
         e.voltage_avg_diff_60m,
         f.penetration_offsigma_1m,
         f.energy_offsigma_1m,
         f.droptime_offsigma_1m,
         f.stickout_offsigma_1m,
         f.lift_offsigma_1m,
         f.time_offsigma_1m,
         f.current_offsigma_1m,
         f.voltage_offsigma_1m,
         g.penetration_offsigma_5m,
         g.energy_offsigma_5m,
         g.droptime_offsigma_5m,
         g.stickout_offsigma_5m,
         g.lift_offsigma_5m,
         g.time_offsigma_5m,
         g.current_offsigma_5m,
         g.voltage_offsigma_5m,
         h.penetration_offsigma_15m,
         h.energy_offsigma_15m,
         h.droptime_offsigma_15m,
         h.stickout_offsigma_15m,
         h.lift_offsigma_15m,
         h.time_offsigma_15m,
         h.current_offsigma_15m,
         h.voltage_offsigma_15m,
         i.penetration_offsigma_60m,
         i.energy_offsigma_60m,
         i.droptime_offsigma_60m,
         i.stickout_offsigma_60m,
         i.lift_offsigma_60m,
         i.time_offsigma_60m,
         i.current_offsigma_60m,
         i.voltage_offsigma_60m,
         j.penetration_avg_distance,
         j.penetration_up_limit_distance,
         j.penetration_low_limit_distance,
         j.penetration_offsigma_distance,
         j.penetration_is_offsigma,
         j.energy_avg_distance,
         j.energy_up_limit_distance,
         j.energy_low_limit_distance,
         j.energy_offsigma_distance,
         j.energy_is_offsigma,
         j.drop_time_avg_distance,
         j.drop_time_up_limit_distance,
         j.drop_time_low_limit_distance,
         j.drop_time_offsigma_distance,
         j.drop_time_is_offsigma,
         j.stickout_avg_distance,
         j.stickout_up_limit_distance,
         j.stickout_low_limit_distance,
         j.stickout_offsigma_distance,
         j.stickout_is_offsigma,
         j.lift_avg_distance,
         j.lift_up_limit_distance,
         j.lift_low_limit_distance,
         j.lift_offsigma_distance,
         j.lift_is_offsigma,
         j.time_avg_distance,
         j.time_up_limit_distance,
         j.time_low_limit_distance,
         j.time_offsigma_distance,
         j.time_is_offsigma,
         j.current_avg_distance,
         j.current_up_limit_distance,
         j.current_low_limit_distance,
         j.current_offsigma_distance,
         j.current_is_offsigma,
         j.voltage_avg_distance,
         j.voltage_up_limit_distance,
         j.voltage_low_limit_distance,
         j.voltage_offsigma_distance,
         j.voltage_is_offsigma,
         a."score",
         a."BodyShopRepair",
         a."AssemblyShopRepair",
         a."Error"
from welds_25_datasets a
     left join welds_25_datasets_avg_features_1m b on a.fingerprint = b.fingerprint
     left join welds_25_datasets_avg_features_5m c on a.fingerprint = c.fingerprint
     left join welds_25_datasets_avg_features_15m d on a.fingerprint = d.fingerprint
     left join welds_25_datasets_avg_features_60m e on a.fingerprint = e.fingerprint
     left join welds_25_datasets_sigma_features_1m f on a.fingerprint = f.fingerprint
     left join welds_25_datasets_sigma_features_5m g on a.fingerprint = g.fingerprint
     left join welds_25_datasets_sigma_features_15m h on a.fingerprint = h.fingerprint
     left join welds_25_datasets_sigma_features_60m i on a.fingerprint = i.fingerprint
     left join welds_25_datasets_cur_weld_features j on a.fingerprint = j.fingerprint;

