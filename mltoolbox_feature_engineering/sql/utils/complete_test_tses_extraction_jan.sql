-- TRAIN OCT-DEC vs TEST JAN
-- select all extensions with both repairs in both training and test with at least 100 training welds
(select a.tool_stud_ext
from imp_hits_all a
where a.timestamp >= '2020-10-01' and a.timestamp < '2021-01-01' and
      exists (select 1 from tmp_repaired_studs b
              where b.stud_id = a.stud_id and
                    b.carbody_id = a.carbody_id and 
                    b.repaired_at is not null and
                    not exists (select 1 from tmp_weldtimeactual_zero c where c.fingerprint = a.fingerprint) and
                    (b.repaired_at = 'Assembly Shop' or (b.repaired_at = 'Body Shop' and b.error_code in ('2000','3000'))))
group by a.tool_stud_ext)
intersect
(select x.tool_stud_ext from
    (select b.tool_stud_ext, count(1) from imp_hits_all b where b.timestamp >= '2020-10-01' and b.timestamp < '2021-01-01' group by b.tool_stud_ext having count(1) > 3000) x)
intersect
(select a.tool_stud_ext
from imp_hits_all a
where a.timestamp >= '2021-01-01' and a.timestamp < '2021-02-01' and
      exists (select 1 from tmp_repaired_studs b
              where b.stud_id = a.stud_id and
                    b.carbody_id = a.carbody_id and 
                    b.repaired_at is not null and
                    not exists (select 1 from tmp_weldtimeactual_zero c where c.fingerprint = a.fingerprint) and
                   (b.repaired_at = 'Assembly Shop' or (b.repaired_at = 'Body Shop' and b.error_code in ('2000','3000'))))
group by a.tool_stud_ext);

--- 44 TSEs 1 repair train + 1 repair test (min 3000 welds test)

050-213-Z1-UB63-070-100-101-1.1-610619_213_3_1_1_2_1_1
050-213-Z1-UB64-120-200-201-2.1-620773_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610636_213_3_1_1_2_1_1
050-213-Z1-UB64-110-100-101-1.1-620669_213_1_1_1_1_1_1
050-213-Z1-UB64-060-400-401-2.1-610762_213_3_1_1_2_1_2
050-213-Z1-UB63-140-200-201-1.1-620760_213_3_1_1_2_1_1
050-213-Z1-UB63-100-200-201-1.1-620645_213_1_1_1_2_1_2
050-213-Z1-UB64-030-400-401-2.1-610762_213_3_1_1_2_1_1
050-213-Z1-UB64-140-100-101-1.1-620598_213_1_1_1_1_1_2
050-213-Z1-UB63-090-100-101-1.1-610653_213_3_1_1_2_1_2
050-213-Z1-UB64-060-400-401-2.1-610762_213_1_1_1_2_1_2
050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1
050-213-Z1-UB64-040-200-201-2.1-620776_213_1_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610653_213_1_1_1_2_1_2
050-213-Z1-UB64-060-400-401-2.1-610761_213_1_1_1_2_1_2
050-213-Z1-UB64-130-200-201-2.1-611219_213_1_1_1_2_1_2
050-213-Z1-UB63-140-300-301-1.1-620420_213_1_1_1_2_1_1
050-213-Z1-UB63-140-200-201-1.1-620422_213_1_2_1_2_1_1
050-213-Z1-UB63-070-100-101-1.1-610619_213_1_1_1_2_1_1
050-223-Z2-RS75-080-400-401-2.1-6300134_223_4_1_3_1_1_1
050-223-Z1-UB73-090-500-501-1.1-6100363_223_4_1_0_1_1_2
050-223-Z1-UB73-090-500-501-1.1-6100523_223_4_1_0_1_1_2
050-223-Z1-UB73-100-400-401-1.1-6100361_223_4_1_0_1_1_1
050-223-Z1-UB74-020-100-101-1.1-6100020_223_4_1_0_1_1_2
050-223-Z1-UB74-020-100-101-1.1-6100663_223_4_1_0_1_1_2
050-223-Z1-UB75-030-500-501-1.1-6100429_223_4_1_3_1_1_2
050-223-Z1-UB75-050-100-101-1.1-6100636_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-2.1-6300046_223_4_1_3_1_1_1
050-223-Z1-VB73-070-200-201-1.1-6200148_223_4_1_0_1_1_2
050-223-Z2-RS75-080-400-401-2.1-6300045_223_4_1_3_1_1_1
050-223-Z1-VB73-070-300-301-1.1-6200067_223_4_1_0_1_1_1
050-223-Z1-UB73-100-400-401-1.1-6100456_223_4_1_0_1_1_1
050-223-Z1-UB75-030-400-401-1.1-6200026_223_4_1_3_1_1_2
050-223-Z1-UB73-100-400-401-1.1-6100440_223_4_1_0_1_1_1
050-223-Z1-UB73-090-400-401-1.1-6100684_223_4_1_0_1_1_2
050-223-Z1-UB74-030-100-101-1.1-6100642_223_4_1_0_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100421_223_4_1_0_1_1_1
050-223-Z1-UB73-100-500-501-1.1-6100517_223_4_1_0_1_1_1
050-223-Z1-UB73-100-200-201-1.1-6200213_223_4_1_0_1_1_1
050-223-Z1-UB73-100-300-301-1.1-6100106_223_4_1_0_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100420_223_4_1_0_1_1_1
050-223-Z1-UB74-070-300-301-1.1-6100021_223_4_1_0_1_1_2
050-223-Z1-UB73-090-400-401-1.1-6100440_223_4_1_0_1_1_2
050-223-Z1-UB75-030-500-501-1.1-6100438_223_4_1_3_1_1_2



-- train repairs but no test
(select a.tool_stud_ext
from imp_hits_all a
where a.timestamp >= '2020-10-01' and a.timestamp < '2021-01-01' and
      not exists (select 1 from tmp_repaired_studs b
              where b.stud_id = a.stud_id and
                    b.carbody_id = a.carbody_id and 
                    b.repaired_at is not null and
                    not exists (select 1 from tmp_weldtimeactual_zero c where c.fingerprint = a.fingerprint) and
                    (b.repaired_at = 'Assembly Shop' or (b.repaired_at = 'Body Shop' and b.error_code in ('2000','3000'))))
group by a.tool_stud_ext)
intersect
(select x.tool_stud_ext from
    (select b.tool_stud_ext, count(1) from imp_hits_all b where b.timestamp >= '2020-10-01' and b.timestamp < '2021-01-01' group by b.tool_stud_ext having count(1) > 3000) x)
intersect
(select a.tool_stud_ext
from imp_hits_all a
where a.timestamp >= '2021-01-01' and a.timestamp < '2021-02-01' and
      exists (select 1 from tmp_repaired_studs b
              where b.stud_id = a.stud_id and
                    b.carbody_id = a.carbody_id and 
                    b.repaired_at is not null and
                    not exists (select 1 from tmp_weldtimeactual_zero c where c.fingerprint = a.fingerprint) and
                   (b.repaired_at = 'Assembly Shop' or (b.repaired_at = 'Body Shop' and b.error_code in ('2000','3000'))))
group by a.tool_stud_ext);

050-213-Z1-UB63-100-200-201-1.1-620590_213_1_1_1_2_1_2
050-213-Z1-UB63-130-300-301-1.1-610794_213_1_1_1_2_1_1
050-213-Z1-UB64-030-100-101-1.1-620096_213_1_1_1_2_1_1
050-213-Z1-UB63-140-200-201-1.1-620504_213_1_1_1_2_1_1
050-213-Z1-UB64-170-300-301-1.1-620658_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610586_213_1_1_1_2_1_1
050-213-Z1-UB63-090-200-201-1.1-620542_213_1_1_1_2_1_2
050-213-Z1-UB63-090-100-101-1.1-610648_213_1_1_1_2_1_2
050-213-Z1-UB63-130-100-101-2.1-610800_213_1_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610630_213_1_1_1_2_1_2
050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1
050-213-Z1-UB64-040-200-201-2.1-620776_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610740_213_1_1_1_2_1_1
050-213-Z1-UB63-130-200-201-1.1-611363_213_1_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610653_213_1_1_1_2_1_2
050-213-Z1-UB63-100-200-201-1.1-620566_213_1_1_1_2_1_2
050-213-Z1-UB64-040-300-301-1.1-611084_213_1_1_1_2_1_1
050-213-Z1-UB63-130-100-101-1.1-620556_213_1_1_1_2_1_1
050-213-Z1-UB63-140-200-201-1.1-620620_213_1_1_1_2_1_1
050-213-Z1-UB63-100-200-201-1.1-620667_213_1_1_1_2_1_2
050-213-Z1-UB64-030-200-201-2.1-610499_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610761_213_1_1_1_2_1_1
050-213-Z1-UB63-110-400-401-1.1-620725_213_1_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610649_213_1_1_1_2_1_2
050-213-Z1-UB63-090-200-201-1.1-620576_213_1_1_1_2_1_2
050-213-Z1-UB63-140-300-301-1.1-620420_213_1_1_1_2_1_1
050-213-Z1-UB63-100-200-201-1.1-620645_213_1_1_1_2_1_2
050-213-Z1-UB63-100-100-101-1.1-610654_213_1_1_1_2_1_2
050-213-Z1-UB63-130-100-101-2.1-610813_213_1_1_1_2_1_1
050-213-Z1-UB63-130-200-201-1.1-610798_213_1_1_1_2_1_1
050-223-Z2-RS75-080-400-401-2.1-6300134_223_4_1_3_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100433_223_4_1_0_1_1_1
050-213-Z1-UB63-140-200-201-1.1-620760_213_1_1_1_2_1_1
050-213-Z1-UB63-100-200-201-1.1-620568_213_1_1_1_2_1_2
050-223-Z1-UB75-050-100-101-1.1-6100637_223_4_1_0_1_1_1
050-223-Z1-UB75-050-300-301-1.1-6200111_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-1.1-6300023_223_4_1_3_1_1_1
050-223-Z2-RS75-080-400-401-1.1-6300022_223_4_1_3_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100421_223_4_1_0_1_1_1
050-223-Z1-VB73-070-100-101-1.1-6200027_223_4_1_0_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100424_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-1.1-6300075_223_4_1_3_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100636_223_4_1_0_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100420_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-2.1-6300046_223_4_1_3_1_1_1
050-223-Z1-UB75-050-300-301-1.1-6100129_223_4_1_0_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100422_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-1.1-6300027_223_4_1_3_1_1_1
050-223-Z2-RS75-080-400-401-2.1-6300045_223_4_1_3_1_1_1
050-223-Z1-VB73-070-100-101-1.1-6200029_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-1.1-6300021_223_4_1_3_1_1_1


-- test repairs but no train
(select a.tool_stud_ext
from imp_hits_all a
where a.timestamp >= '2020-10-01' and a.timestamp < '2021-01-01' and
      exists (select 1 from tmp_repaired_studs b
              where b.stud_id = a.stud_id and
                    b.carbody_id = a.carbody_id and 
                    b.repaired_at is not null and
                    not exists (select 1 from tmp_weldtimeactual_zero c where c.fingerprint = a.fingerprint) and
                    (b.repaired_at = 'Assembly Shop' or (b.repaired_at = 'Body Shop' and b.error_code in ('2000','3000'))))
group by a.tool_stud_ext)
intersect
(select x.tool_stud_ext from
    (select b.tool_stud_ext, count(1) from imp_hits_all b where b.timestamp >= '2020-10-01' and b.timestamp < '2021-01-01' group by b.tool_stud_ext having count(1) > 10000) x)
intersect
(select a.tool_stud_ext
from imp_hits_all a
where a.timestamp >= '2021-01-01' and a.timestamp < '2021-02-01' and
      not exists (select 1 from tmp_repaired_studs b
              where b.stud_id = a.stud_id and
                    b.carbody_id = a.carbody_id and 
                    b.repaired_at is not null and
                    not exists (select 1 from tmp_weldtimeactual_zero c where c.fingerprint = a.fingerprint) and
                   (b.repaired_at = 'Assembly Shop' or (b.repaired_at = 'Body Shop' and b.error_code in ('2000','3000'))))
group by a.tool_stud_ext);

050-213-Z1-UB63-100-200-201-1.1-620590_213_1_1_1_2_1_2
050-213-Z1-UB63-130-300-301-1.1-610794_213_1_1_1_2_1_1
050-213-Z1-UB64-030-100-101-1.1-620096_213_1_1_1_2_1_1
050-213-Z1-UB63-140-200-201-1.1-620504_213_1_1_1_2_1_1
050-213-Z1-UB64-170-300-301-1.1-620658_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610586_213_1_1_1_2_1_1
050-213-Z1-UB63-090-200-201-1.1-620542_213_1_1_1_2_1_2
050-213-Z1-UB63-090-100-101-1.1-610648_213_1_1_1_2_1_2
050-213-Z1-UB63-130-100-101-2.1-610800_213_1_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610630_213_1_1_1_2_1_2
050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1
050-213-Z1-UB64-040-200-201-2.1-620776_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610740_213_1_1_1_2_1_1
050-213-Z1-UB63-130-200-201-1.1-611363_213_1_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610653_213_1_1_1_2_1_2
050-213-Z1-UB63-100-200-201-1.1-620566_213_1_1_1_2_1_2
050-213-Z1-UB64-040-300-301-1.1-611084_213_1_1_1_2_1_1
050-213-Z1-UB63-130-100-101-1.1-620556_213_1_1_1_2_1_1
050-213-Z1-UB63-140-200-201-1.1-620620_213_1_1_1_2_1_1
050-213-Z1-UB63-100-200-201-1.1-620667_213_1_1_1_2_1_2
050-223-Z1-UB75-050-100-101-1.1-6100636_223_4_1_0_1_1_1
050-213-Z1-UB64-030-200-201-2.1-610499_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610761_213_1_1_1_2_1_1
050-213-Z1-UB63-110-400-401-1.1-620725_213_1_1_1_2_1_1
050-223-Z1-UB75-050-100-101-1.1-6100420_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-2.1-6300046_223_4_1_3_1_1_1
050-213-Z1-UB63-090-100-101-1.1-610649_213_1_1_1_2_1_2
050-213-Z1-UB63-090-200-201-1.1-620576_213_1_1_1_2_1_2
050-223-Z1-UB75-050-300-301-1.1-6100129_223_4_1_0_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100422_223_4_1_0_1_1_1
050-213-Z1-UB63-140-300-301-1.1-620420_213_1_1_1_2_1_1
050-223-Z2-RS75-080-400-401-1.1-6300027_223_4_1_3_1_1_1
050-213-Z1-UB63-100-200-201-1.1-620645_213_1_1_1_2_1_2
050-223-Z2-RS75-080-400-401-1.1-6300021_223_4_1_3_1_1_1
050-213-Z1-UB63-100-100-101-1.1-610654_213_1_1_1_2_1_2
050-223-Z2-RS75-080-400-401-2.1-6300045_223_4_1_3_1_1_1
050-223-Z1-VB73-070-100-101-1.1-6200029_223_4_1_0_1_1_1
050-213-Z1-UB63-130-100-101-2.1-610813_213_1_1_1_2_1_1
050-213-Z1-UB63-130-200-201-1.1-610798_213_1_1_1_2_1_1
050-223-Z2-RS75-080-400-401-2.1-6300134_223_4_1_3_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100433_223_4_1_0_1_1_1
050-213-Z1-UB63-140-200-201-1.1-620760_213_1_1_1_2_1_1
050-213-Z1-UB63-100-200-201-1.1-620568_213_1_1_1_2_1_2
050-223-Z1-UB75-050-100-101-1.1-6100637_223_4_1_0_1_1_1
050-223-Z1-UB75-050-300-301-1.1-6200111_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-1.1-6300023_223_4_1_3_1_1_1
050-223-Z2-RS75-080-400-401-1.1-6300022_223_4_1_3_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100421_223_4_1_0_1_1_1
050-223-Z1-VB73-070-100-101-1.1-6200027_223_4_1_0_1_1_1
050-223-Z1-UB75-050-100-101-1.1-6100424_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-1.1-6300075_223_4_1_3_1_1_1



-- train and test assembly repairs
(select a.tool_stud_ext
from imp_hits_all a
where a.timestamp >= '2020-10-01' and a.timestamp < '2021-01-01' and
      exists (select 1 from tmp_repaired_studs b
              where b.stud_id = a.stud_id and
                    b.carbody_id = a.carbody_id and 
                    b.repaired_at is not null and
                    not exists (select 1 from tmp_weldtimeactual_zero c where c.fingerprint = a.fingerprint) and
                    b.repaired_at = 'Assembly Shop')
group by a.tool_stud_ext)
intersect
(select x.tool_stud_ext from
    (select b.tool_stud_ext, count(1) from imp_hits_all b where b.timestamp >= '2020-10-01' and b.timestamp < '2021-01-01' group by b.tool_stud_ext having count(1) > 3000) x)
intersect
(select a.tool_stud_ext
from imp_hits_all a
where a.timestamp >= '2021-01-01' and a.timestamp < '2021-02-01' and
      exists (select 1 from tmp_repaired_studs b
              where b.stud_id = a.stud_id and
                    b.carbody_id = a.carbody_id and 
                    b.repaired_at is not null and
                    not exists (select 1 from tmp_weldtimeactual_zero c where c.fingerprint = a.fingerprint) and
                    b.repaired_at = 'Assembly Shop')
group by a.tool_stud_ext);

050-213-Z1-UB63-070-100-101-1.1-610619_213_3_1_1_2_1_1
050-213-Z1-UB64-060-400-401-2.1-610762_213_1_1_1_2_1_2
050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610653_213_1_1_1_2_1_2
050-213-Z1-UB64-060-400-401-2.1-610762_213_3_1_1_2_1_2
050-213-Z1-UB63-100-200-201-1.1-620645_213_1_1_1_2_1_2
050-213-Z1-UB63-070-100-101-1.1-610619_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610762_213_3_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610653_213_3_1_1_2_1_2
050-223-Z1-UB73-100-400-401-1.1-6100440_223_4_1_0_1_1_1
050-223-Z1-UB74-020-100-101-1.1-6100663_223_4_1_0_1_1_2
050-223-Z1-UB73-090-400-401-1.1-6100440_223_4_1_0_1_1_2
050-223-Z1-UB73-100-200-201-1.1-6200213_223_4_1_0_1_1_1
050-223-Z1-UB75-030-500-501-1.1-6100429_223_4_1_3_1_1_2
050-223-Z2-RS75-080-400-401-2.1-6300046_223_4_1_3_1_1_1


-- test assembly repairs only (not in train)
(select a.tool_stud_ext
from imp_hits_all a
where a.timestamp >= '2020-10-01' and a.timestamp < '2021-01-01' and
      not exists (select 1 from tmp_repaired_studs b
              where b.stud_id = a.stud_id and
                    b.carbody_id = a.carbody_id and 
                    b.repaired_at is not null and
                    not exists (select 1 from tmp_weldtimeactual_zero c where c.fingerprint = a.fingerprint) and
                    b.repaired_at = 'Assembly Shop')
group by a.tool_stud_ext)
intersect
(select x.tool_stud_ext from
    (select b.tool_stud_ext, count(1) from imp_hits_all b where b.timestamp >= '2020-10-01' and b.timestamp < '2021-01-01' group by b.tool_stud_ext having count(1) > 3000) x)
intersect
(select a.tool_stud_ext
from imp_hits_all a
where a.timestamp >= '2021-01-01' and a.timestamp < '2021-02-01' and
      exists (select 1 from tmp_repaired_studs b
              where b.stud_id = a.stud_id and
                    b.carbody_id = a.carbody_id and 
                    b.repaired_at is not null and
                    not exists (select 1 from tmp_weldtimeactual_zero c where c.fingerprint = a.fingerprint) and
                    b.repaired_at = 'Assembly Shop')
group by a.tool_stud_ext);


050-213-Z1-UB64-140-100-101-1.1-610443_213_3_1_1_2_1_2
050-213-Z1-UB64-130-400-401-1.1-620094_213_1_1_1_2_1_2
050-213-Z1-UB64-030-400-401-2.1-610762_213_3_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610653_213_3_1_1_2_1_2
050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1
050-213-Z1-UB63-100-200-201-1.1-620645_213_1_1_1_2_1_2
050-213-Z1-UB63-080-200-201-1.1-620584_213_3_1_1_2_1_1
050-213-Z1-UB63-070-100-101-1.1-610619_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610636_213_3_1_1_2_1_1
050-213-Z1-UB63-140-200-201-1.1-620760_213_3_1_1_2_1_1
050-213-Z1-UB63-070-200-201-1.1-620645_213_1_1_1_2_1_1
050-213-Z1-UB64-110-100-101-1.1-620482_213_1_1_1_2_1_1
050-213-Z1-UB64-060-100-101-1.1-611048_213_1_1_1_2_1_2
050-223-Z1-UB75-030-500-501-1.1-6100429_223_4_1_3_1_1_2
050-213-Z1-UB63-070-200-201-1.1-620574_213_1_1_1_1_1_1
050-213-Z1-UB64-060-400-401-2.1-610762_213_3_1_1_2_1_2
050-213-Z1-UB64-160-300-301-1.1-611220_213_3_1_1_2_1_2
050-223-Z1-UB73-100-400-401-1.1-6100440_223_4_1_0_1_1_1
050-223-Z1-UB74-020-100-101-1.1-6100663_223_4_1_0_1_1_2
050-223-Z1-UB75-020-300-301-1.1-6100136_223_4_1_3_1_1_1
050-213-Z1-UB64-060-400-401-2.1-610762_213_1_1_1_2_1_2
050-213-Z1-UB64-060-400-401-2.1-610761_213_1_1_1_2_1_2
050-213-Z1-UB63-140-300-301-1.1-620516_213_1_2_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610880_213_3_1_1_2_1_2
050-213-Z1-UB63-090-200-201-1.1-620570_213_3_1_1_2_1_2
050-223-Z1-UB73-100-200-201-1.1-6200213_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-2.1-6300046_223_4_1_3_1_1_1
050-223-Z1-UB74-030-100-101-1.1-6100663_223_4_1_0_1_1_1
050-223-Z1-UB73-100-200-201-1.1-6200039_223_4_1_0_1_1_1
050-223-Z1-UB73-090-400-401-1.1-6100440_223_4_1_0_1_1_2
050-213-Z1-UB63-080-100-101-1.1-610865_213_3_1_1_2_1_1
050-223-Z1-UB75-030-400-401-1.1-6200026_223_4_1_3_1_1_2
050-223-Z1-UB75-030-400-401-1.1-6200060_223_4_1_3_1_1_2
050-223-Z1-UB75-050-100-101-1.1-6100636_223_4_1_0_1_1_1
050-223-Z1-UB74-020-100-101-1.1-6100037_223_4_1_0_1_1_2




-- final TSE list
-- repairs in both train and test 10
050-213-Z1-UB64-120-200-201-2.1-620773_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610636_213_3_1_1_2_1_1
050-213-Z1-UB64-110-100-101-1.1-620669_213_1_1_1_1_1_1
050-213-Z1-UB63-140-200-201-1.1-620760_213_3_1_1_2_1_1
050-213-Z1-UB64-140-100-101-1.1-620598_213_1_1_1_1_1_2
050-213-Z1-UB64-040-200-201-2.1-620776_213_1_1_1_2_1_1
050-213-Z1-UB64-060-400-401-2.1-610761_213_1_1_1_2_1_2
050-213-Z1-UB64-130-200-201-2.1-611219_213_1_1_1_2_1_2
050-213-Z1-UB63-140-300-301-1.1-620420_213_1_1_1_2_1_1
050-213-Z1-UB63-140-200-201-1.1-620422_213_1_2_1_2_1_1
-- 9 assembly test+train
050-213-Z1-UB63-070-100-101-1.1-610619_213_3_1_1_2_1_1
050-213-Z1-UB64-060-400-401-2.1-610762_213_1_1_1_2_1_2
050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610653_213_1_1_1_2_1_2
050-213-Z1-UB64-060-400-401-2.1-610762_213_3_1_1_2_1_2
050-213-Z1-UB63-100-200-201-1.1-620645_213_1_1_1_2_1_2
050-213-Z1-UB63-070-100-101-1.1-610619_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610762_213_3_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610653_213_3_1_1_2_1_2
-- 5 assembly test-only
050-213-Z1-UB63-100-100-101-1.1-610619_213_1_1_1_2_1_2
050-213-Z1-UB63-070-200-201-1.1-620590_213_3_1_1_2_1_1
050-213-Z1-UB64-160-300-301-1.1-611220_213_1_1_1_2_1_2
050-213-Z1-UB63-080-100-101-1.1-610865_213_3_1_1_2_1_1
050-213-Z1-UB63-080-200-201-1.1-620584_213_3_1_1_2_1_1
-- 5 train-only repairs 
050-213-Z1-UB63-100-200-201-1.1-620590_213_1_1_1_2_1_2
050-213-Z1-UB63-130-300-301-1.1-610794_213_1_1_1_2_1_1
050-213-Z1-UB64-030-100-101-1.1-620096_213_1_1_1_2_1_1
050-213-Z1-UB63-140-200-201-1.1-620504_213_1_1_1_2_1_1
050-213-Z1-UB64-170-300-301-1.1-620658_213_1_1_1_2_1_1







--- COMPLETE LIST
create table tses (tse varchar(100));

insert into tses (tse) values ('050-213-Z1-UB63-070-100-101-1.1-610619_213_3_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-120-200-201-2.1-620773_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610636_213_3_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-110-100-101-1.1-620669_213_1_1_1_1_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-060-400-401-2.1-610762_213_3_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-140-200-201-1.1-620760_213_3_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-100-200-201-1.1-620645_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610762_213_3_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-140-100-101-1.1-620598_213_1_1_1_1_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-090-100-101-1.1-610653_213_3_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-060-400-401-2.1-610762_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-040-200-201-2.1-620776_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-090-100-101-1.1-610653_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-060-400-401-2.1-610761_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-130-200-201-2.1-611219_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-140-300-301-1.1-620420_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-140-200-201-1.1-620422_213_1_2_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-070-100-101-1.1-610619_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-223-Z2-RS75-080-400-401-2.1-6300134_223_4_1_3_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB73-090-500-501-1.1-6100363_223_4_1_0_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB73-090-500-501-1.1-6100523_223_4_1_0_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB73-100-400-401-1.1-6100361_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB74-020-100-101-1.1-6100020_223_4_1_0_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB74-020-100-101-1.1-6100663_223_4_1_0_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB75-030-500-501-1.1-6100429_223_4_1_3_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB75-050-100-101-1.1-6100636_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z2-RS75-080-400-401-2.1-6300046_223_4_1_3_1_1_1');
insert into tses (tse) values ('050-223-Z1-VB73-070-200-201-1.1-6200148_223_4_1_0_1_1_2');
insert into tses (tse) values ('050-223-Z2-RS75-080-400-401-2.1-6300045_223_4_1_3_1_1_1');
insert into tses (tse) values ('050-223-Z1-VB73-070-300-301-1.1-6200067_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB73-100-400-401-1.1-6100456_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB75-030-400-401-1.1-6200026_223_4_1_3_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB73-100-400-401-1.1-6100440_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB73-090-400-401-1.1-6100684_223_4_1_0_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB74-030-100-101-1.1-6100642_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB75-050-100-101-1.1-6100421_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB73-100-500-501-1.1-6100517_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB73-100-200-201-1.1-6200213_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB73-100-300-301-1.1-6100106_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB75-050-100-101-1.1-6100420_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB74-070-300-301-1.1-6100021_223_4_1_0_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB73-090-400-401-1.1-6100440_223_4_1_0_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB75-030-500-501-1.1-6100438_223_4_1_3_1_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-070-100-101-1.1-610619_213_3_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-060-400-401-2.1-610762_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-090-100-101-1.1-610653_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-060-400-401-2.1-610762_213_3_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-100-200-201-1.1-620645_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-070-100-101-1.1-610619_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610762_213_3_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-090-100-101-1.1-610653_213_3_1_1_2_1_2');
insert into tses (tse) values ('050-223-Z1-UB73-100-400-401-1.1-6100440_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB74-020-100-101-1.1-6100663_223_4_1_0_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB73-090-400-401-1.1-6100440_223_4_1_0_1_1_2');
insert into tses (tse) values ('050-223-Z1-UB73-100-200-201-1.1-6200213_223_4_1_0_1_1_1');
insert into tses (tse) values ('050-223-Z1-UB75-030-500-501-1.1-6100429_223_4_1_3_1_1_2');
insert into tses (tse) values ('050-223-Z2-RS75-080-400-401-2.1-6300046_223_4_1_3_1_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-100-200-201-1.1-620590_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-130-300-301-1.1-610794_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-030-100-101-1.1-620096_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-140-200-201-1.1-620504_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-170-300-301-1.1-620658_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610586_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-090-200-201-1.1-620542_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-090-100-101-1.1-610648_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-130-100-101-2.1-610800_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-090-100-101-1.1-610630_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-100-200-201-1.1-620590_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-130-300-301-1.1-610794_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-030-100-101-1.1-620096_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-140-200-201-1.1-620504_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-170-300-301-1.1-620658_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610586_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-090-200-201-1.1-620542_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-090-100-101-1.1-610648_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-130-100-101-2.1-610800_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-090-100-101-1.1-610630_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-040-200-201-2.1-620776_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610740_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-140-100-101-1.1-610443_213_3_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-130-400-401-1.1-620094_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610762_213_3_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-090-100-101-1.1-610653_213_3_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-100-200-201-1.1-620645_213_1_1_1_2_1_2');
insert into tses (tse) values ('050-213-Z1-UB63-080-200-201-1.1-620584_213_3_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-070-100-101-1.1-610619_213_1_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB64-030-400-401-2.1-610636_213_3_1_1_2_1_1');
insert into tses (tse) values ('050-213-Z1-UB63-140-200-201-1.1-620760_213_3_1_1_2_1_1');

050-213-Z1-UB63-100-200-201-1.1-620590_213_1_1_1_2_1_2
050-213-Z1-UB63-130-300-301-1.1-610794_213_1_1_1_2_1_1
050-223-Z1-UB73-090-500-501-1.1-6100363_223_4_1_0_1_1_2
050-223-Z1-UB73-090-500-501-1.1-6100523_223_4_1_0_1_1_2
050-213-Z1-UB63-070-100-101-1.1-610619_213_3_1_1_2_1_1
050-223-Z1-UB73-100-400-401-1.1-6100361_223_4_1_0_1_1_1
050-213-Z1-UB64-030-100-101-1.1-620096_213_1_1_1_2_1_1
050-223-Z1-UB74-020-100-101-1.1-6100020_223_4_1_0_1_1_2
050-213-Z1-UB63-140-200-201-1.1-620504_213_1_1_1_2_1_1
050-213-Z1-UB64-170-300-301-1.1-620658_213_1_1_1_2_1_1
050-223-Z1-UB75-030-400-401-1.1-6200026_223_4_1_3_1_1_2
050-223-Z1-UB73-100-400-401-1.1-6100440_223_4_1_0_1_1_1
050-213-Z1-UB64-030-400-401-2.1-610586_213_1_1_1_2_1_1
050-213-Z1-UB63-090-200-201-1.1-620542_213_1_1_1_2_1_2
050-223-Z1-UB74-020-100-101-1.1-6100663_223_4_1_0_1_1_2
050-223-Z1-UB73-090-400-401-1.1-6100684_223_4_1_0_1_1_2
050-213-Z1-UB63-080-200-201-1.1-620584_213_3_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610648_213_1_1_1_2_1_2
050-223-Z1-UB74-030-100-101-1.1-6100642_223_4_1_0_1_1_1
050-213-Z1-UB64-060-400-401-2.1-610762_213_1_1_1_2_1_2
050-223-Z1-UB75-050-100-101-1.1-6100421_223_4_1_0_1_1_1
050-213-Z1-UB63-130-100-101-2.1-610800_213_1_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610630_213_1_1_1_2_1_2
050-213-Z1-UB64-030-400-401-2.1-610762_213_1_1_1_2_1_1
050-213-Z1-UB64-030-400-401-2.1-610740_213_1_1_1_2_1_1
050-213-Z1-UB64-040-200-201-2.1-620776_213_1_1_1_2_1_1
050-223-Z1-UB73-100-500-501-1.1-6100517_223_4_1_0_1_1_1
050-213-Z1-UB63-090-100-101-1.1-610653_213_1_1_1_2_1_2
050-213-Z1-UB64-120-200-201-2.1-620773_213_1_1_1_2_1_1
050-223-Z1-UB73-100-200-201-1.1-6200213_223_4_1_0_1_1_1
050-213-Z1-UB64-140-100-101-1.1-610443_213_3_1_1_2_1_2
050-213-Z1-UB64-030-400-401-2.1-610636_213_3_1_1_2_1_1
050-223-Z1-UB75-030-500-501-1.1-6100429_223_4_1_3_1_1_2
050-223-Z1-UB75-050-100-101-1.1-6100636_223_4_1_0_1_1_1
050-213-Z1-UB64-110-100-101-1.1-620669_213_1_1_1_1_1_1
050-223-Z1-UB73-100-300-301-1.1-6100106_223_4_1_0_1_1_1
050-213-Z1-UB64-060-400-401-2.1-610761_213_1_1_1_2_1_2
050-223-Z1-UB75-050-100-101-1.1-6100420_223_4_1_0_1_1_1
050-223-Z1-UB74-070-300-301-1.1-6100021_223_4_1_0_1_1_2
050-223-Z2-RS75-080-400-401-2.1-6300046_223_4_1_3_1_1_1
050-213-Z1-UB64-060-400-401-2.1-610762_213_3_1_1_2_1_2
050-223-Z1-VB73-070-200-201-1.1-6200148_223_4_1_0_1_1_2
050-213-Z1-UB64-130-200-201-2.1-611219_213_1_1_1_2_1_2
050-213-Z1-UB63-140-200-201-1.1-620760_213_3_1_1_2_1_1
050-223-Z1-UB73-090-400-401-1.1-6100440_223_4_1_0_1_1_2
050-213-Z1-UB64-130-400-401-1.1-620094_213_1_1_1_2_1_2
050-213-Z1-UB63-140-300-301-1.1-620420_213_1_1_1_2_1_1
050-213-Z1-UB63-140-200-201-1.1-620422_213_1_2_1_2_1_1
050-213-Z1-UB63-100-200-201-1.1-620645_213_1_1_1_2_1_2
050-223-Z1-UB75-030-500-501-1.1-6100438_223_4_1_3_1_1_2
050-223-Z2-RS75-080-400-401-2.1-6300045_223_4_1_3_1_1_1
050-213-Z1-UB63-070-100-101-1.1-610619_213_1_1_1_2_1_1
050-223-Z1-VB73-070-300-301-1.1-6200067_223_4_1_0_1_1_1
050-223-Z2-RS75-080-400-401-2.1-6300134_223_4_1_3_1_1_1
050-223-Z1-UB73-100-400-401-1.1-6100456_223_4_1_0_1_1_1
050-213-Z1-UB64-030-400-401-2.1-610762_213_3_1_1_2_1_1
050-213-Z1-UB63-090-100-101-1.1-610653_213_3_1_1_2_1_2
050-213-Z1-UB64-140-100-101-1.1-620598_213_1_1_1_1_1_2

-- Candi queries to extract files
\set d1 '''2020-10-01''' 
\set d2 '''2021-02-01'''
\set filename '''/tmp/tmp_assembly_mappings_58TSE.csv'''
copy (select a.production_nr "Production Number",a.carbody_id "Carbody Number" from mst_cars_mapping a
      where a.production_nr in (select a.production_nr
                               from tmp_repaired_studs a
                               where repaired_at = 'Assembly Shop' and
                                     exists (select 1 from imp_hits_all b
                                             where b.carbody_id=a.carbody_id and b.stud_id=a.stud_id and b.timestamp between :d1 and :d2 and
                                                   ((b.tool='050-213-Z1-UB63-100-200-201-1.1' and b.stud_id_ext='620590_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB63-130-300-301-1.1' and b.stud_id_ext='610794_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-090-500-501-1.1' and b.stud_id_ext='6100363_223_4_1_0_1_1_2') or
                                                    (b.tool='050-223-Z1-UB73-090-500-501-1.1' and b.stud_id_ext='6100523_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB63-070-100-101-1.1' and b.stud_id_ext='610619_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-400-401-1.1' and b.stud_id_ext='6100361_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-030-100-101-1.1' and b.stud_id_ext='620096_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB74-020-100-101-1.1' and b.stud_id_ext='6100020_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB63-140-200-201-1.1' and b.stud_id_ext='620504_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB64-170-300-301-1.1' and b.stud_id_ext='620658_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB75-030-400-401-1.1' and b.stud_id_ext='6200026_223_4_1_3_1_1_2') or
                                                    (b.tool='050-223-Z1-UB73-100-400-401-1.1' and b.stud_id_ext='6100440_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610586_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-200-201-1.1' and b.stud_id_ext='620542_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB74-020-100-101-1.1' and b.stud_id_ext='6100663_223_4_1_0_1_1_2') or
                                                    (b.tool='050-223-Z1-UB73-090-400-401-1.1' and b.stud_id_ext='6100684_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB63-080-200-201-1.1' and b.stud_id_ext='620584_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610648_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB74-030-100-101-1.1' and b.stud_id_ext='6100642_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-060-400-401-2.1' and b.stud_id_ext='610762_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB75-050-100-101-1.1' and b.stud_id_ext='6100421_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB63-130-100-101-2.1' and b.stud_id_ext='610800_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610630_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610762_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610740_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB64-040-200-201-2.1' and b.stud_id_ext='620776_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-500-501-1.1' and b.stud_id_ext='6100517_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610653_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-120-200-201-2.1' and b.stud_id_ext='620773_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-200-201-1.1' and b.stud_id_ext='6200213_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-140-100-101-1.1' and b.stud_id_ext='610443_213_3_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610636_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB75-030-500-501-1.1' and b.stud_id_ext='6100429_223_4_1_3_1_1_2') or
                                                    (b.tool='050-223-Z1-UB75-050-100-101-1.1' and b.stud_id_ext='6100636_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-110-100-101-1.1' and b.stud_id_ext='620669_213_1_1_1_1_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-300-301-1.1' and b.stud_id_ext='6100106_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-060-400-401-2.1' and b.stud_id_ext='610761_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB75-050-100-101-1.1' and b.stud_id_ext='6100420_223_4_1_0_1_1_1') or
                                                    (b.tool='050-223-Z1-UB74-070-300-301-1.1' and b.stud_id_ext='6100021_223_4_1_0_1_1_2') or
                                                    (b.tool='050-223-Z2-RS75-080-400-401-2.1' and b.stud_id_ext='6300046_223_4_1_3_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-060-400-401-2.1' and b.stud_id_ext='610762_213_3_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-VB73-070-200-201-1.1' and b.stud_id_ext='6200148_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB64-130-200-201-2.1' and b.stud_id_ext='611219_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB63-140-200-201-1.1' and b.stud_id_ext='620760_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-090-400-401-1.1' and b.stud_id_ext='6100440_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB64-130-400-401-1.1' and b.stud_id_ext='620094_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB63-140-300-301-1.1' and b.stud_id_ext='620420_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-140-200-201-1.1' and b.stud_id_ext='620422_213_1_2_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-100-200-201-1.1' and b.stud_id_ext='620645_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB75-030-500-501-1.1' and b.stud_id_ext='6100438_223_4_1_3_1_1_2') or
                                                    (b.tool='050-223-Z2-RS75-080-400-401-2.1' and b.stud_id_ext='6300045_223_4_1_3_1_1_1') or
                                                    (b.tool='050-213-Z1-UB63-070-100-101-1.1' and b.stud_id_ext='610619_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-VB73-070-300-301-1.1' and b.stud_id_ext='6200067_223_4_1_0_1_1_1') or
                                                    (b.tool='050-223-Z2-RS75-080-400-401-2.1' and b.stud_id_ext='6300134_223_4_1_3_1_1_1') or
                                                    (b.tool='050-223-Z1-UB73-100-400-401-1.1' and b.stud_id_ext='6100456_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610762_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610653_213_3_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-140-100-101-1.1' and b.stud_id_ext='620598_213_1_1_1_1_1_2'))))
     ) to :filename DELIMITER ',' CSV HEADER;


\set filename '''/tmp/tmp_assembly_repairs_58TSE.csv'''
copy (select a.assembly_date "Date",
             a.car_type "CarType",
             a.production_nr "ProductionNumber",
             a.production_nr2 "Production Number with Extension",
             case when a.repaired_out_of_line='Yes' then 'x' else '' end "Repaired out of Line Yes/No",
             a.stud_id "StudID",
             a.stud_type "StudType",
             a.bad_weld "Bad Weld",
             a.stud_bended "Stud bended",
             a.stud_missing "Stud Missing",
             a.stud_shifted "Stud shifted",
             a.plant_station "Plant - Station in Bodyshop",
             a.bodyshop_date "Production in Bodyshop"
      from tmp_repaired_studs a
      where repaired_at = 'Assembly Shop' and
            exists (select 1 from imp_hits_all b
                    where b.carbody_id=a.carbody_id and b.stud_id=a.stud_id and
                          b.timestamp between :d1 and :d2 and
                                                   ((b.tool='050-213-Z1-UB63-100-200-201-1.1' and b.stud_id_ext='620590_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB63-130-300-301-1.1' and b.stud_id_ext='610794_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-090-500-501-1.1' and b.stud_id_ext='6100363_223_4_1_0_1_1_2') or
                                                    (b.tool='050-223-Z1-UB73-090-500-501-1.1' and b.stud_id_ext='6100523_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB63-070-100-101-1.1' and b.stud_id_ext='610619_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-400-401-1.1' and b.stud_id_ext='6100361_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-030-100-101-1.1' and b.stud_id_ext='620096_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB74-020-100-101-1.1' and b.stud_id_ext='6100020_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB63-140-200-201-1.1' and b.stud_id_ext='620504_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB64-170-300-301-1.1' and b.stud_id_ext='620658_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB75-030-400-401-1.1' and b.stud_id_ext='6200026_223_4_1_3_1_1_2') or
                                                    (b.tool='050-223-Z1-UB73-100-400-401-1.1' and b.stud_id_ext='6100440_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610586_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-200-201-1.1' and b.stud_id_ext='620542_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB74-020-100-101-1.1' and b.stud_id_ext='6100663_223_4_1_0_1_1_2') or
                                                    (b.tool='050-223-Z1-UB73-090-400-401-1.1' and b.stud_id_ext='6100684_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB63-080-200-201-1.1' and b.stud_id_ext='620584_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610648_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB74-030-100-101-1.1' and b.stud_id_ext='6100642_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-060-400-401-2.1' and b.stud_id_ext='610762_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB75-050-100-101-1.1' and b.stud_id_ext='6100421_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB63-130-100-101-2.1' and b.stud_id_ext='610800_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610630_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610762_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610740_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB64-040-200-201-2.1' and b.stud_id_ext='620776_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-500-501-1.1' and b.stud_id_ext='6100517_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610653_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-120-200-201-2.1' and b.stud_id_ext='620773_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-200-201-1.1' and b.stud_id_ext='6200213_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-140-100-101-1.1' and b.stud_id_ext='610443_213_3_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610636_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB75-030-500-501-1.1' and b.stud_id_ext='6100429_223_4_1_3_1_1_2') or
                                                    (b.tool='050-223-Z1-UB75-050-100-101-1.1' and b.stud_id_ext='6100636_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-110-100-101-1.1' and b.stud_id_ext='620669_213_1_1_1_1_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-300-301-1.1' and b.stud_id_ext='6100106_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-060-400-401-2.1' and b.stud_id_ext='610761_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB75-050-100-101-1.1' and b.stud_id_ext='6100420_223_4_1_0_1_1_1') or
                                                    (b.tool='050-223-Z1-UB74-070-300-301-1.1' and b.stud_id_ext='6100021_223_4_1_0_1_1_2') or
                                                    (b.tool='050-223-Z2-RS75-080-400-401-2.1' and b.stud_id_ext='6300046_223_4_1_3_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-060-400-401-2.1' and b.stud_id_ext='610762_213_3_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-VB73-070-200-201-1.1' and b.stud_id_ext='6200148_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB64-130-200-201-2.1' and b.stud_id_ext='611219_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB63-140-200-201-1.1' and b.stud_id_ext='620760_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-090-400-401-1.1' and b.stud_id_ext='6100440_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB64-130-400-401-1.1' and b.stud_id_ext='620094_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB63-140-300-301-1.1' and b.stud_id_ext='620420_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-140-200-201-1.1' and b.stud_id_ext='620422_213_1_2_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-100-200-201-1.1' and b.stud_id_ext='620645_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB75-030-500-501-1.1' and b.stud_id_ext='6100438_223_4_1_3_1_1_2') or
                                                    (b.tool='050-223-Z2-RS75-080-400-401-2.1' and b.stud_id_ext='6300045_223_4_1_3_1_1_1') or
                                                    (b.tool='050-213-Z1-UB63-070-100-101-1.1' and b.stud_id_ext='610619_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-VB73-070-300-301-1.1' and b.stud_id_ext='6200067_223_4_1_0_1_1_1') or
                                                    (b.tool='050-223-Z2-RS75-080-400-401-2.1' and b.stud_id_ext='6300134_223_4_1_3_1_1_1') or
                                                    (b.tool='050-223-Z1-UB73-100-400-401-1.1' and b.stud_id_ext='6100456_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610762_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610653_213_3_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-140-100-101-1.1' and b.stud_id_ext='620598_213_1_1_1_1_1_2')))
     ) to :filename DELIMITER ',' CSV HEADER;

\set filename '''/tmp/tmp_body_repairs_58TSE.csv'''
copy (select a.car_type "Car Type",
             a.stud_id "Stud ID",
             a.carbody_id_7 "Carbody ID",
             a.bodyshop_date "Documentation time",
             a.stud_type "Stud Type",
             a.plant_station "Failure in Station",
             a.error_code "Error Code",
             a.detected_as_wop "Detected as WOP"
      from tmp_repaired_studs a
      where repaired_at = 'Body Shop' and
            exists (select 1 from imp_hits_all b where b.carbody_id=a.carbody_id and b.stud_id=a.stud_id and b.timestamp between :d1 and :d2 and
                                                   ((b.tool='050-213-Z1-UB63-100-200-201-1.1' and b.stud_id_ext='620590_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB63-130-300-301-1.1' and b.stud_id_ext='610794_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-090-500-501-1.1' and b.stud_id_ext='6100363_223_4_1_0_1_1_2') or
                                                    (b.tool='050-223-Z1-UB73-090-500-501-1.1' and b.stud_id_ext='6100523_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB63-070-100-101-1.1' and b.stud_id_ext='610619_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-400-401-1.1' and b.stud_id_ext='6100361_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-030-100-101-1.1' and b.stud_id_ext='620096_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB74-020-100-101-1.1' and b.stud_id_ext='6100020_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB63-140-200-201-1.1' and b.stud_id_ext='620504_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB64-170-300-301-1.1' and b.stud_id_ext='620658_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB75-030-400-401-1.1' and b.stud_id_ext='6200026_223_4_1_3_1_1_2') or
                                                    (b.tool='050-223-Z1-UB73-100-400-401-1.1' and b.stud_id_ext='6100440_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610586_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-200-201-1.1' and b.stud_id_ext='620542_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB74-020-100-101-1.1' and b.stud_id_ext='6100663_223_4_1_0_1_1_2') or
                                                    (b.tool='050-223-Z1-UB73-090-400-401-1.1' and b.stud_id_ext='6100684_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB63-080-200-201-1.1' and b.stud_id_ext='620584_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610648_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB74-030-100-101-1.1' and b.stud_id_ext='6100642_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-060-400-401-2.1' and b.stud_id_ext='610762_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB75-050-100-101-1.1' and b.stud_id_ext='6100421_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB63-130-100-101-2.1' and b.stud_id_ext='610800_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610630_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610762_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610740_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB64-040-200-201-2.1' and b.stud_id_ext='620776_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-500-501-1.1' and b.stud_id_ext='6100517_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610653_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-120-200-201-2.1' and b.stud_id_ext='620773_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-200-201-1.1' and b.stud_id_ext='6200213_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-140-100-101-1.1' and b.stud_id_ext='610443_213_3_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610636_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB75-030-500-501-1.1' and b.stud_id_ext='6100429_223_4_1_3_1_1_2') or
                                                    (b.tool='050-223-Z1-UB75-050-100-101-1.1' and b.stud_id_ext='6100636_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-110-100-101-1.1' and b.stud_id_ext='620669_213_1_1_1_1_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-100-300-301-1.1' and b.stud_id_ext='6100106_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-060-400-401-2.1' and b.stud_id_ext='610761_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB75-050-100-101-1.1' and b.stud_id_ext='6100420_223_4_1_0_1_1_1') or
                                                    (b.tool='050-223-Z1-UB74-070-300-301-1.1' and b.stud_id_ext='6100021_223_4_1_0_1_1_2') or
                                                    (b.tool='050-223-Z2-RS75-080-400-401-2.1' and b.stud_id_ext='6300046_223_4_1_3_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-060-400-401-2.1' and b.stud_id_ext='610762_213_3_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-VB73-070-200-201-1.1' and b.stud_id_ext='6200148_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB64-130-200-201-2.1' and b.stud_id_ext='611219_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB63-140-200-201-1.1' and b.stud_id_ext='620760_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-UB73-090-400-401-1.1' and b.stud_id_ext='6100440_223_4_1_0_1_1_2') or
                                                    (b.tool='050-213-Z1-UB64-130-400-401-1.1' and b.stud_id_ext='620094_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB63-140-300-301-1.1' and b.stud_id_ext='620420_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-140-200-201-1.1' and b.stud_id_ext='620422_213_1_2_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-100-200-201-1.1' and b.stud_id_ext='620645_213_1_1_1_2_1_2')  or
                                                    (b.tool='050-223-Z1-UB75-030-500-501-1.1' and b.stud_id_ext='6100438_223_4_1_3_1_1_2') or
                                                    (b.tool='050-223-Z2-RS75-080-400-401-2.1' and b.stud_id_ext='6300045_223_4_1_3_1_1_1') or
                                                    (b.tool='050-213-Z1-UB63-070-100-101-1.1' and b.stud_id_ext='610619_213_1_1_1_2_1_1')  or
                                                    (b.tool='050-223-Z1-VB73-070-300-301-1.1' and b.stud_id_ext='6200067_223_4_1_0_1_1_1') or
                                                    (b.tool='050-223-Z2-RS75-080-400-401-2.1' and b.stud_id_ext='6300134_223_4_1_3_1_1_1') or
                                                    (b.tool='050-223-Z1-UB73-100-400-401-1.1' and b.stud_id_ext='6100456_223_4_1_0_1_1_1') or
                                                    (b.tool='050-213-Z1-UB64-030-400-401-2.1' and b.stud_id_ext='610762_213_3_1_1_2_1_1')  or
                                                    (b.tool='050-213-Z1-UB63-090-100-101-1.1' and b.stud_id_ext='610653_213_3_1_1_2_1_2')  or
                                                    (b.tool='050-213-Z1-UB64-140-100-101-1.1' and b.stud_id_ext='620598_213_1_1_1_1_1_2'))))
     to :filename DELIMITER ',' CSV HEADER;




